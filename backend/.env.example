# OvaInsightXAI Backend Environment Configuration
# Copy this file to .env and configure for your deployment

# ============================================================================
# Server Configuration
# ============================================================================

# Port to run the server on (default: 8000)
PORT=8000

# Allowed origins for CORS (comma-separated)
# For production, replace with your actual frontend URL
ALLOWED_ORIGINS=http://localhost:3000,https://your-frontend-domain.com

# ============================================================================
# Model Configuration
# ============================================================================

# Path to the ovarian cancer model file (optional, uses default if not set)
# MODEL_PATH=/app/app/model/model.pkl

# Allow downloading model from CDN if not found (set to 1 to enable)
# ALLOW_MODEL_DOWNLOAD=0

# Brain tumor model architecture (if state_dict requires manual specification)
# Common options: pvt_v2_b1, resnet50, efficientnet_b0, vit_base_patch16_224
# BRAIN_TUMOR_MODEL_ARCH=pvt_v2_b1

# ============================================================================
# Performance Tuning
# ============================================================================

# Number of threads for numerical computations (reduce for memory-constrained environments)
OMP_NUM_THREADS=2
MKL_NUM_THREADS=2
OPENBLAS_NUM_THREADS=2
TORCH_NUM_THREADS=2

# Python settings
PYTHONUNBUFFERED=1
PYTHONDONTWRITEBYTECODE=1

# ============================================================================
# Logging
# ============================================================================

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# ============================================================================
# XAI Performance Tuning (Explainable AI)
# ============================================================================
# CRITICAL: These settings prevent 100% CPU usage during brain tumor analysis

# Master controls
XAI_ENABLED=true                # Set to false to completely disable XAI
XAI_PARALLEL=false              # KEEP FALSE to avoid CPU spikes (sequential is safer)
XAI_ESSENTIAL_ONLY=false        # All 5 methods enabled (SHAP, LIME, PDP, ICE, ALE)
XAI_TIMEOUT_SECONDS=60          # Timeout for each XAI computation

# SHAP (Occlusion-based sensitivity) - ULTRA-LIGHT
SHAP_IMAGE_PATCH_SIZE=48        # Larger patch = fewer grid cells (default: 48)
SHAP_IMAGE_STRIDE=24            # Larger stride = fewer positions (default: 24)
SHAP_IMAGE_BATCH_SIZE=32        # Batch size for inference

# LIME (Local Interpretable Model-agnostic Explanations) - ULTRA-LIGHT
LIME_IMAGE_NUM_SAMPLES=50       # Reduced samples (default: 50, was 300)
LIME_IMAGE_BATCH_SIZE=25        # Larger batch = fewer forward passes
LIME_IMAGE_NUM_FEATURES=5       # Fewer features to return

# PDP (Partial Dependence Plots) - skipped by default when XAI_ESSENTIAL_ONLY=true
PDP_IMAGE_GRID_SIZE=3           # Grid size for patches (3x3=9)
PDP_IMAGE_N_GRID_POINTS=5       # Number of intensity levels

# ICE (Individual Conditional Expectation) - skipped by default
ICE_IMAGE_GRID_SIZE=3
ICE_IMAGE_N_GRID_POINTS=5
ICE_IMAGE_N_SAMPLES=3

# ALE (Accumulated Local Effects) - skipped by default
ALE_IMAGE_GRID_SIZE=3
ALE_IMAGE_N_BINS=4
